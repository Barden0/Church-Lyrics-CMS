<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Worship Lyrics – Lower Third</title>

<link href="https://fonts.googleapis.com/css2?family=Raleway:wght@500;600&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    background: transparent;
    overflow: hidden;
    font-family: 'Raleway', Arial, Helvetica, sans-serif;
  }

  #container {
    position: absolute;
    bottom: 9%;
    width: 100%;
    display: flex;
    justify-content: center;
    pointer-events: none;
  }

  #lyric {
    max-width: 80%;
    text-align: center;
    font-size: 48px;
    line-height: 1.4;
    color: #ffffff;
    opacity: 0;
    transition: opacity 300ms ease;
    text-shadow:
      2px 2px 6px rgba(0,0,0,0.85),
      0px 0px 12px rgba(0,0,0,0.6);
  }

  #lyric.show {
    opacity: 1;
  }
</style>
</head>

<body>

<div id="container">
  <div id="lyric"></div>
</div>

<script>
document.body.tabIndex = 0;
function forceFocus() { document.body.focus(); }
window.onload = forceFocus;
setInterval(forceFocus, 1000);

let lyrics = [];
let index = 0;
let visible = true;

const lyricEl = document.getElementById("lyric");

fetch("song-lyrics.txt")

  .then(response => response.text())
  .then(text => {
    lyrics = text
      .split("\n")
      .map(line => line.trim())
      .filter(line => line !== "" && !line.startsWith("#"))
      .map(line => {
        if (line === "—") return "—";
        return line.replace("|", "<br>");
      });

    showLyric();
  })
  .catch(() => {
    lyricEl.innerHTML = "";
  });

function showLyric() {
  if (!lyrics[index] || lyrics[index] === "—") {
    lyricEl.classList.remove("show");
    return;
  }
  lyricEl.innerHTML = lyrics[index];
  lyricEl.classList.add("show");
}

function hideLyric() {
  lyricEl.classList.remove("show");
}

document.addEventListener("keydown", (e) => {
  switch (e.key) {
    case "ArrowRight":
    case " ":
      if (index < lyrics.length - 1) {
        hideLyric();
        setTimeout(() => {
          index++;
          showLyric();
        }, 150);
      }
      break;

    case "ArrowLeft":
      if (index > 0) {
        hideLyric();
        setTimeout(() => {
          index--;
          showLyric();
        }, 150);
      }
      break;

    case "0":
      visible = !visible;
      if (visible) showLyric();
      else hideLyric();
      break;
  }
});
</script>

</body>
</html>
